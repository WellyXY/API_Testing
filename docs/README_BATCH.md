# 🎬 Parrot 批量視頻生成器

一個支持多圖批量生成和一鍵全部下載的 Parrot 視頻生成工具。

## ✨ 主要功能

### 1. 多圖批量生成
- 一次上傳多張圖片（支持拖拽和多選）
- 使用統一的 Prompt 對所有圖片進行視頻生成
- 並行處理，提高生成效率
- 實時進度監控

### 2. 一鍵全部下載
- 任務完成後自動打包所有生成的視頻
- 一鍵下載 ZIP 壓縮包
- 文件名包含原始圖片名稱，便於識別

### 3. 任務管理
- 實時狀態監控（等待中、處理中、已完成）
- 詳細進度顯示（成功/失敗數量）
- 錯誤日誌記錄
- 任務刪除和清理功能

## 🚀 快速開始

### 方法一：使用啟動腳本（推薦）
```bash
python start_batch_server.py
```

### 方法二：手動啟動
1. 安裝依賴：
```bash
pip install -r requirements.txt
```

2. 啟動服務器：
```bash
python parrot_batch_server.py
```

3. 打開瀏覽器訪問：
```
http://localhost:5004
```

## 📖 使用說明

### 步驟 1：配置 API Key
在網頁界面中輸入你的 Parrot API Key

### 步驟 2：輸入提示詞
輸入想要的視頻效果描述，這個 Prompt 會應用到所有上傳的圖片

示例提示詞：
```
a sexy woman giving a blowjob, realistic, high quality
```

### 步驟 3：上傳圖片
- 點擊上傳區域選擇多張圖片
- 或直接拖拽圖片到上傳區域
- 支持 JPG、PNG 格式
- 建議每張圖片小於 10MB

### 步驟 4：開始批量生成
點擊「🚀 開始批量生成」按鈕，系統會：
1. 創建批量任務
2. 並行處理所有圖片
3. 實時更新進度

### 步驟 5：監控進度
- 查看任務列表中的實時進度
- 觀察成功/失敗的視頻數量
- 檢查錯誤日誌（如有）

### 步驟 6：下載視頻
任務完成後點擊「📦 一鍵下載所有視頻」按鈕，系統會：
1. 自動打包所有生成的視頻
2. 下載 ZIP 壓縮包到本地
3. ZIP 文件名格式：`batch_videos_{任務ID}.zip`

## 🔧 技術特性

### 後端功能
- **並行處理**：使用 ThreadPoolExecutor 同時處理多個視頻生成請求
- **任務管理**：完整的任務生命週期管理
- **文件管理**：自動處理上傳、存儲、下載和清理
- **錯誤處理**：完善的錯誤捕獲和日誌記錄
- **API 代理**：解決跨域問題，提供統一的 API 接口

### 前端功能
- **拖拽上傳**：支持拖拽多選圖片上傳
- **實時刷新**：每 5 秒自動刷新任務狀態
- **進度可視化**：直觀的進度條和統計信息
- **響應式設計**：適配不同設備屏幕

## 📁 文件結構

```
├── parrot_batch_server.py      # 批量處理服務器
├── batch_frontend.html       # 前端界面
├── start_batch_server.py     # 啟動腳本
├── requirements.txt          # 依賴包列表
├── uploads/                  # 上傳圖片臨時存儲
├── generated_videos/         # 生成的視頻文件
└── downloads/               # 下載壓縮包存儲
```

## 🎯 API 端點

- `POST /batch/generate` - 開始批量生成
- `GET /batch/tasks` - 獲取所有任務列表
- `GET /batch/status/{task_id}` - 獲取特定任務狀態
- `GET /batch/download/{task_id}` - 下載任務的所有視頻
- `DELETE /batch/delete/{task_id}` - 刪除任務和相關文件

## ⚠️ 注意事項

1. **API Key**：確保使用有效的 Parrot API Key
2. **網路連接**：穩定的網路連接對視頻生成很重要
3. **存儲空間**：確保有足夠的磁盤空間存儲視頻文件
4. **並發限制**：默認最多同時處理 3 個視頻生成請求
5. **超時設置**：單個視頻最長等待時間為 5 分鐘

## 🔄 版本更新

### v1.0.0
- ✅ 多圖批量上傳
- ✅ 並行視頻生成
- ✅ 實時進度監控
- ✅ 一鍵下載功能
- ✅ 任務管理系統
- ✅ 錯誤處理和日誌

## 🤝 支持

如果遇到問題，請檢查：
1. API Key 是否正確
2. 網路連接是否穩定
3. 圖片格式是否支持
4. 瀏覽器控制台是否有錯誤信息

---

**享受批量視頻生成的便利！** 🎉 